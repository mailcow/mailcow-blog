<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=de><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è - mailcow: dockerized - Blog</title><meta name=author content="Moohoo">
<meta name=author-link content="servercow.de"><meta name=description content="Moohoo zusammen!
Wie bereits im letzten Blog Eintrag (vom 30.05.2023) angek√ºndigt, folgt hier die detaillierte CVE zum Sicherheitspatch 2023-05a.
Solltet ihr noch nicht upgedatet haben, solltet ihr das damit schleunigst tun, da nun ein Exploit √∂ffentlich im Internet steht, welche authentifizierte Benutzer auf eurem E-Mail Server ausnutzen k√∂nnten."><meta name=keywords content="2023,sicherheit,wichtig,cve"><meta itemprop=name content="‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è"><meta itemprop=description content="Moohoo zusammen!
Wie bereits im letzten Blog Eintrag (vom 30.05.2023) angek√ºndigt, folgt hier die detaillierte CVE zum Sicherheitspatch 2023-05a.
Solltet ihr noch nicht upgedatet haben, solltet ihr das damit schleunigst tun, da nun ein Exploit √∂ffentlich im Internet steht, welche authentifizierte Benutzer auf eurem E-Mail Server ausnutzen k√∂nnten."><meta itemprop=datePublished content="2023-06-07T09:30:10+02:00"><meta itemprop=dateModified content="2023-11-21T10:43:45+01:00"><meta itemprop=wordCount content="382"><meta itemprop=image content="https://mailcow.email/images/cow_mailcow.svg"><meta itemprop=keywords content="2023,sicherheit,wichtig,cve,"><meta property="og:title" content="‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è"><meta property="og:description" content="Moohoo zusammen!
Wie bereits im letzten Blog Eintrag (vom 30.05.2023) angek√ºndigt, folgt hier die detaillierte CVE zum Sicherheitspatch 2023-05a.
Solltet ihr noch nicht upgedatet haben, solltet ihr das damit schleunigst tun, da nun ein Exploit √∂ffentlich im Internet steht, welche authentifizierte Benutzer auf eurem E-Mail Server ausnutzen k√∂nnten."><meta property="og:type" content="article"><meta property="og:url" content="https://mailcow.email/de/posts/2023/cve-2023-34108/"><meta property="og:image" content="https://mailcow.email/images/cow_mailcow.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-07T09:30:10+02:00"><meta property="article:modified_time" content="2023-11-21T10:43:45+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mailcow.email/images/cow_mailcow.svg"><meta name=twitter:title content="‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è"><meta name=twitter:description content="Moohoo zusammen!
Wie bereits im letzten Blog Eintrag (vom 30.05.2023) angek√ºndigt, folgt hier die detaillierte CVE zum Sicherheitspatch 2023-05a.
Solltet ihr noch nicht upgedatet haben, solltet ihr das damit schleunigst tun, da nun ein Exploit √∂ffentlich im Internet steht, welche authentifizierte Benutzer auf eurem E-Mail Server ausnutzen k√∂nnten."><meta name=twitter:site content="@mailcow_email"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://mailcow.email/de/posts/2023/cve-2023-34108/><link rel=prev href=https://mailcow.email/de/posts/2023/release-2023-05a/><link rel=next href=https://mailcow.email/de/posts/2023/spamhaus-dnsblocklist/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è","inLanguage":"de","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mailcow.email\/de\/posts\/2023\/cve-2023-34108\/"},"genre":"posts","keywords":"2023, sicherheit, wichtig, cve","wordcount":382,"url":"https:\/\/mailcow.email\/de\/posts\/2023\/cve-2023-34108\/","datePublished":"2023-06-07T09:30:10+02:00","dateModified":"2023-11-21T10:43:45+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Niklas Meyer/DerLinkman"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=fixed><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/de/ title="mailcow: dockerized - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/cow_mailcow.svg data-srcset="/images/cow_mailcow.svg, /images/cow_mailcow.svg 1.5x, /images/cow_mailcow.svg 2x" data-sizes=auto alt="mailcow: dockerized - Blog" title="mailcow: dockerized - Blog"><span class=header-title-text>mailcow: dockerized - Blog</span><span class=header-title-post>üì∞</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/de/posts/>Beitr√§ge</a></li><li class=menu-item><a class=menu-link href=/de/tags/>Tags</a></li><li class=menu-item><a class=menu-link href=/de/categories/>Kategorien</a></li><li class=menu-item><a class=menu-link href=https://mailcow.github.io/mailcow-dockerized-docs/de rel="noopener noreferrer" target=_blank><i class='fa fa-book'></i> Dokumentation</a></li><li class=menu-item><a class=menu-link href=https://www.eth-services.de/ssd-vps/ rel="noopener noreferrer" target=_blank><i class='fa fa-server'></i> VPS</a></li><li class=menu-item><a class=menu-link href=https://www.servercow.de/mailcow#support title="Support erhalten" rel="noopener noreferrer" target=_blank><i class='fas fa-band-aid'></i> Support</a></li><li class=menu-item><a class=menu-link href=https://github.com/mailcow/mailcow-dockerized title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i> GitHub</a></li><li class="menu-item has-children"><a class=menu-link href=https://demo.mailcow.email title=Demos rel="noopener noreferrer" target=_blank><i class='fa fa-play'></i> Demos</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://demo.mailcow.email title="Stabile Demo" rel="noopener noreferrer" target=_blank>Stabile Demo</a></li><li class=menu-item><a class=menu-link href=https://nightly-demo.mailcow.email title="Nightly Demo" rel="noopener noreferrer" target=_blank>Nightly Demo</a></li></ul></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label="Sprache w√§hlen" title="Sprache w√§hlen">Deutsch<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a href=/posts/2023/cve-2023-34108/ class=menu-link title=English>English</a></li></ul></li><li class="menu-item theme-switch" title="Darstellung √§ndern"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/de/ title="mailcow: dockerized - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/cow_mailcow.svg data-srcset="/images/cow_mailcow.svg, /images/cow_mailcow.svg 1.5x, /images/cow_mailcow.svg 2x" data-sizes=auto alt=/images/cow_mailcow.svg title=/images/cow_mailcow.svg><span class=header-title-text>mailcow: dockerized - Blog</span><span class=header-title-post>üì∞</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=menu-item><a class=menu-link href=/de/posts/>Beitr√§ge</a></li><li class=menu-item><a class=menu-link href=/de/tags/>Tags</a></li><li class=menu-item><a class=menu-link href=/de/categories/>Kategorien</a></li><li class=menu-item><a class=menu-link href=https://mailcow.github.io/mailcow-dockerized-docs/de rel="noopener noreferrer" target=_blank><i class='fa fa-book'></i> Dokumentation</a></li><li class=menu-item><a class=menu-link href=https://www.eth-services.de/ssd-vps/ rel="noopener noreferrer" target=_blank><i class='fa fa-server'></i> VPS</a></li><li class=menu-item><a class=menu-link href=https://www.servercow.de/mailcow#support title="Support erhalten" rel="noopener noreferrer" target=_blank><i class='fas fa-band-aid'></i> Support</a></li><li class=menu-item><a class=menu-link href=https://github.com/mailcow/mailcow-dockerized title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i> GitHub</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=https://demo.mailcow.email title=Demos rel="noopener noreferrer" target=_blank><i class='fa fa-play'></i> Demos</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://demo.mailcow.email title="Stabile Demo" rel="noopener noreferrer" target=_blank>Stabile Demo</a></li><li class=menu-item><a class=menu-link href=https://nightly-demo.mailcow.email title="Nightly Demo" rel="noopener noreferrer" target=_blank>Nightly Demo</a></li></ul></li><li class="menu-item theme-switch" title="Darstellung √§ndern"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label="Sprache w√§hlen" title="Sprache w√§hlen">Deutsch<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i>
</span><select class=language-select onchange="location=this.value"><option value=/posts/2023/cve-2023-34108/>English</option><option value=/de/posts/2023/cve-2023-34108/ selected disabled>Deutsch</option></select></li></ul></nav></div></header><main class=container data-page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>Inhalt&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>‚ö†Ô∏è CVE-2023-34108 : Manipulation von internen Dovecot-Variablen in mailcow √ºber pr√§parierte Passw√∂rter ‚ö†Ô∏è</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/DerLinkman title=Autor target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Niklas Meyer/DerLinkman</a></span>
<span class=post-category>enthalten in <a href=/de/categories/cve/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CVE</a>&ensp;<a href=/de/categories/hotfix/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Hotfix</a>&ensp;<a href=/de/categories/sicherheitshinweise/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Sicherheitshinweise</a></span></div><div class=post-meta-line><span title="2023-06-07 09:30:10"><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=07.06.2023>07.06.2023</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i> 382 W√∂rter</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden=true></i> 2 Minuten</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Inhalt</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#worum-geht-es>Worum geht es?</a></li><li><a href=#was-wurde-gegen-diese-sicherheitsl√ºcke-unternommen>Was wurde gegen diese Sicherheitsl√ºcke unternommen?</a></li><li><a href=#welche-versionen-von-mailcow-dockerized-sind-betroffen>Welche Versionen von mailcow: dockerized sind betroffen?</a></li><li><a href=#gibt-es-einen-workaround-f√ºr-das-problem-damit-ich-nicht-updaten-muss>Gibt es einen Workaround f√ºr das Problem, damit ich nicht Updaten muss?</a></li><li><a href=#referenzen>Referenzen</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>Moohoo zusammen!</strong></p><p>Wie bereits im letzten Blog Eintrag (vom 30.05.2023) angek√ºndigt, folgt hier die detaillierte CVE zum Sicherheitspatch 2023-05a.</p><p>Solltet ihr noch nicht upgedatet haben, solltet ihr das damit schleunigst tun, da nun ein Exploit √∂ffentlich im Internet steht, welche authentifizierte Benutzer auf eurem E-Mail Server ausnutzen k√∂nnten.</p><h3 id=worum-geht-es>Worum geht es?</h3><p>Am 30.05.2023 wurde eine Sicherheitsl√ºcke in mailcow entdeckt. Die Schwachstelle erm√∂glicht es einem Angreifer, interne Dovecot-Variablen zu manipulieren, indem er speziell gestaltete Passw√∂rter w√§hrend des Authentifizierungsprozesses verwendet.</p><p>Das Problem ergibt sich aus dem Verhalten des Skripts <code>passwd-verify.lua</code>, das f√ºr die Anmeldung verantwortlich ist. Nach einer erfolgreichen Anmeldung gibt das Skript eine Antwort im Format <code>password=</code> zur√ºck, die die erfolgreiche Authentifizierung anzeigt.</p><p>Durch die Erstellung eines Passworts mit zus√§tzlichen Schl√ºssel-Wert-Paaren kann ein Angreifer die zur√ºckgegebene Zeichenfolge manipulieren und das interne Verhalten von Dovecot beeinflussen. Die Verwendung des Passworts <code>123 mail_crypt_save_version=0</code> w√ºrde beispielsweise dazu f√ºhren, dass das Skript <code>passwd-verify.lua</code> die Zeichenfolge <code>password=123 mail_crypt_save_version=0</code> zur√ºckgibt. Folglich interpretiert Dovecot diese Zeichenfolge und setzt die internen Variablen entsprechend, was zu unbeabsichtigten Konsequenzen f√ºhrt.</p><p>Die Schwachstelle kann w√§hrend des Anmeldevorgangs unter Verwendung des speziell erstellten Kennworts ausgenutzt werden, indem das Kennwort in eine bestimmte Payload ge√§ndert wird. Eine erfolgreiche Ausnutzung k√∂nnte zu unberechtigtem Zugriff auf Benutzerkonten, zur Umgehung von Sicherheitskontrollen oder zu anderen b√∂sartigen Aktivit√§ten f√ºhren.</p><h3 id=was-wurde-gegen-diese-sicherheitsl√ºcke-unternommen>Was wurde gegen diese Sicherheitsl√ºcke unternommen?</h3><p>Am selben Tag wurde ein Hotfix (2023-05a) ver√∂ffentlicht, der die Sicherheitsl√ºcke schlie√üt.</p><p>Eine Ausnutzung der Schwachstelle ist damit nicht mehr m√∂glich.</p><h3 id=welche-versionen-von-mailcow-dockerized-sind-betroffen>Welche Versionen von mailcow: dockerized sind betroffen?</h3><blockquote><p>Prinzipiell <strong>alle vor</strong> dem 2023-05a Update.</p></blockquote><p>Besagte <code>passwd-verify.lua</code> befindet sich seit knapp 3 Jahren im mailcow: dockerized Code.</p><h3 id=gibt-es-einen-workaround-f√ºr-das-problem-damit-ich-nicht-updaten-muss>Gibt es einen Workaround f√ºr das Problem, damit ich nicht Updaten muss?</h3><blockquote><p>Kurz gesagt: <strong>NEIN!</strong></p></blockquote><p>Es gibt keinen Workaround f√ºr dieses Problem, da jeder Benutzer sein Passwort selbst √§ndern und setzen kann und diese Funktion nicht durch eine ACL eingeschr√§nkt werden kann.</p><p>Generell empfehlen wir, das Mailsystem regelm√§√üig zu aktualisieren. Updates sind in der IT-Welt sehr wichtig und sch√ºtzen vor Sicherheitsl√ºcken wie dieser.</p><hr><h3 id=referenzen>Referenzen</h3><p>Wir bedanken uns bei dem Finder des Exploits und verweisen auf seine Referenz:</p><p><a href=https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md target=_blank rel="external nofollow noopener noreferrer">https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md</a></p><hr><p>Bei weiteren R√ºckfragen zu dieser CVE z√∂gert bitte nicht uns zu kontaktieren unter <a href=mailto:info@servercow.de>info@servercow.de</a>.</p><p>Bitte sorgt bei eurem E-Mail Server <strong>immer</strong> f√ºr einen aktuellen Patchlevel!</p><p>Ansonsten gilt, was immer gilt:</p><p>Bleibt gesund und happy Mailing!</p><p>Euer mailcow Team</p><blockquote><p>Niklas aka. DerLinkman</p></blockquote></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-11-21 10:43:45">Aktualisiert am 21.11.2023&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/de/tags/2023/>2023</a>,&nbsp;<a href=/de/tags/sicherheit/>sicherheit</a>,&nbsp;<a href=/de/tags/wichtig/>wichtig</a>,&nbsp;<a href=/de/tags/cve/>cve</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Zur√ºck</a></span>&nbsp;|&nbsp;<span><a href=/de/>Startseite</a></span></section></div><div class=post-nav><a href=/de/posts/2023/release-2023-05a/ class=prev rel=prev title="üå∑üêÑ Mooai Update 2023 - Revision A (‚ö†Ô∏è Sicherheitsupdate KRITISCH ‚ö†Ô∏è)"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>üå∑üêÑ Mooai Update 2023 - Revision A (‚ö†Ô∏è Sicherheitsupdate KRITISCH ‚ö†Ô∏è)</a>
<a href=/de/posts/2023/spamhaus-dnsblocklist/ class=next rel=next title="üõëüìú Spamhaus DNS Blocklist √Ñnderungen ab 2023-07">üõëüìú Spamhaus DNS Blocklist √Ñnderungen ab 2023-07<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom"><a href=/de/imprint/>Impressum</a> | <a href=/de/policy/>Datenschutz</div><div class="footer-line powered">Realisiert durch <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.120.4">Hugo</a> | Thema - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.16"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2016 - 2023</span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://tinc.gmbh?kontakt target=_blank>The Infrastructure Company GmbH</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Nach oben"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><div id=mask></div><noscript><div class=noscript-warning>Theme FixIt works best with JavaScript enabled.</div></noscript></div><link rel=stylesheet href=/lib/katex/katex.min.css><script src=/lib/lazysizes/lazysizes.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script>window.config={code:{copyTitle:"In Zwischenablage kopieren",editLockTitle:"Bearbeitbaren Codeblock sperren",editUnLockTitle:"Bearbeiten des Codeblocks entsperren",editable:!0,maxShownLines:10},comment:{enable:!1},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script src=/js/theme.min.js defer></script></body></html>