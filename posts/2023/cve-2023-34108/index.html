<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è - mailcow: dockerized - Blog</title><meta name=author content>
<meta name=author-link content><meta name=description content="Moohoo everyone!
As announced in the last blog entry (dated 30.05.2023), here is the detailed CVE for security patch 2023-05a.
If you have not yet updated, you should do so as soon as possible, because an exploit is now publicly available on the Internet that could be exploited by authenticated users on your mail server."><meta name=keywords content='2023,security,important,cve'><meta itemprop=name content="‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è"><meta itemprop=description content="Moohoo everyone!
As announced in the last blog entry (dated 30.05.2023), here is the detailed CVE for security patch 2023-05a.
If you have not yet updated, you should do so as soon as possible, because an exploit is now publicly available on the Internet that could be exploited by authenticated users on your mail server."><meta itemprop=datePublished content="2023-06-07T09:30:10+02:00"><meta itemprop=dateModified content="2024-02-29T12:14:30+01:00"><meta itemprop=wordCount content="377"><meta itemprop=image content="https://mailcow.email/images/cow_mailcow.svg"><meta itemprop=keywords content="2023,security,important,cve,"><meta property="og:title" content="‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è"><meta property="og:description" content="Moohoo everyone!
As announced in the last blog entry (dated 30.05.2023), here is the detailed CVE for security patch 2023-05a.
If you have not yet updated, you should do so as soon as possible, because an exploit is now publicly available on the Internet that could be exploited by authenticated users on your mail server."><meta property="og:type" content="article"><meta property="og:url" content="https://mailcow.email/posts/2023/cve-2023-34108/"><meta property="og:image" content="https://mailcow.email/images/cow_mailcow.svg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-07T09:30:10+02:00"><meta property="article:modified_time" content="2024-02-29T12:14:30+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mailcow.email/images/cow_mailcow.svg"><meta name=twitter:title content="‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è"><meta name=twitter:description content="Moohoo everyone!
As announced in the last blog entry (dated 30.05.2023), here is the detailed CVE for security patch 2023-05a.
If you have not yet updated, you should do so as soon as possible, because an exploit is now publicly available on the Internet that could be exploited by authenticated users on your mail server."><meta name=twitter:site content="@mailcow_email"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://mailcow.email/posts/2023/cve-2023-34108/><link rel=prev href=https://mailcow.email/posts/2023/release-2023-05a/><link rel=next href=https://mailcow.email/posts/2023/spamhaus-dnsblocklist/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mailcow.email\/posts\/2023\/cve-2023-34108\/"},"genre":"posts","keywords":"2023, security, important, cve","wordcount":377,"url":"https:\/\/mailcow.email\/posts\/2023\/cve-2023-34108\/","datePublished":"2023-06-07T09:30:10+02:00","dateModified":"2024-02-29T12:14:30+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Niklas Meyer/DerLinkman"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=fixed><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="mailcow: dockerized - Blog"><img loading=lazy src=/images/cow_mailcow.svg alt="mailcow: dockerized - Blog" data-title="mailcow: dockerized - Blog" class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>mailcow: dockerized - Blog</span><span class=header-title-post>üì∞</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/>Posts</a></li><li class=menu-item><a class=menu-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-link href=https://mailcow.github.io/mailcow-dockerized-docs/ rel="noopener noreferrer" target=_blank><i class='fa fa-book'></i> Docs</a></li><li class="menu-item has-children"><a class=menu-link href=https://mailcow.email title=VPS rel="noopener noreferrer" target=_blank><i class='fa fa-server'></i> VPS</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://eth-services.de title=ETH-Services rel="noopener noreferrer" target=_blank><i>üá©üá™</i> ETH-Services</a></li></ul></li><li class=menu-item><a class=menu-link href="https://www.servercow.de/mailcow?lang=en#support" title="Buy Support" rel="noopener noreferrer" target=_blank><i class='fas fa-band-aid'></i> Support</a></li><li class=menu-item><a class=menu-link href=https://github.com/mailcow/mailcow-dockerized title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i> GitHub</a></li><li class="menu-item has-children"><a class=menu-link href=https://demo.mailcow.email title=Demos rel="noopener noreferrer" target=_blank><i class='fa fa-play'></i> Demos</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://demo.mailcow.email title="Stable Demo" rel="noopener noreferrer" target=_blank>‚úÖ Stable Demo</a></li><li class=menu-item><a class=menu-link href=https://nightly-demo.mailcow.email title="Nightly Demo" rel="noopener noreferrer" target=_blank>üõ†Ô∏è Nightly Demo</a></li></ul></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language-switch"><span role=button aria-label="Select Language" title="Select Language"><i class="fa-solid fa-language fa-fw" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><span class="menu-link text-secondary" title=English>English</span></li><li class=menu-item><a href=/de/posts/2023/cve-2023-34108/ class=menu-link title=Deutsch>Deutsch</a></li></ul></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="mailcow: dockerized - Blog"><img loading=lazy src=/images/cow_mailcow.svg alt=/images/cow_mailcow.svg data-title=/images/cow_mailcow.svg class=logo style="background:url(/images/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title;for(const e of["style","data-title","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>mailcow: dockerized - Blog</span><span class=header-title-post>üì∞</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=menu-item><a class=menu-link href=/posts/>Posts</a></li><li class=menu-item><a class=menu-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-link href=https://mailcow.github.io/mailcow-dockerized-docs/ rel="noopener noreferrer" target=_blank><i class='fa fa-book'></i> Docs</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=https://mailcow.email title=VPS rel="noopener noreferrer" target=_blank><i class='fa fa-server'></i> VPS</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://eth-services.de title=ETH-Services rel="noopener noreferrer" target=_blank><i>üá©üá™</i> ETH-Services</a></li></ul></li><li class=menu-item><a class=menu-link href="https://www.servercow.de/mailcow?lang=en#support" title="Buy Support" rel="noopener noreferrer" target=_blank><i class='fas fa-band-aid'></i> Support</a></li><li class=menu-item><a class=menu-link href=https://github.com/mailcow/mailcow-dockerized title=GitHub rel="noopener noreferrer" target=_blank><i class='fab fa-github fa-fw'></i> GitHub</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=https://demo.mailcow.email title=Demos rel="noopener noreferrer" target=_blank><i class='fa fa-play'></i> Demos</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://demo.mailcow.email title="Stable Demo" rel="noopener noreferrer" target=_blank>‚úÖ Stable Demo</a></li><li class=menu-item><a class=menu-link href=https://nightly-demo.mailcow.email title="Nightly Demo" rel="noopener noreferrer" target=_blank>üõ†Ô∏è Nightly Demo</a></li></ul></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span><span class="menu-system-item language-switch">
<span role=button aria-label="Select Language" title="Select Language">English<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option value=/posts/2023/cve-2023-34108/ selected disabled>English</option><option value=/de/posts/2023/cve-2023-34108/>Deutsch</option></select></span></li></ul></nav></div></header><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=Collections></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>‚ö†Ô∏è CVE-2023-34108 : Manipulation of Internal Dovecot Variables in mailcow via crafted Passwords ‚ö†Ô∏è</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Niklas Meyer/DerLinkman</span></span><span class=post-included-in>&nbsp;included in <a href=/categories/cve/ class=post-category title="Category - CVE"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> CVE</a>&ensp;<a href=/categories/hotfix/ class=post-category title="Category - Hotfix"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Hotfix</a>&ensp;<a href=/categories/security-advisories/ class=post-category title="Category - Security Advisories"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Security Advisories</a></span></div><div class=post-meta-line><span title="published on 2023-06-07 09:30:10"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=06-07-2023>06-07-2023</time></span>&nbsp;<span title="Updated on 2024-02-29 12:14:30"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=02-29-2024>02-29-2024</time></span>&nbsp;<span title="377 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>About 400 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>2 minutes</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#impact>Impact</a></li><li><a href=#what-has-been-done-about-this-vulnerability>What has been done about this vulnerability?</a></li><li><a href=#affected-versions>Affected Versions</a></li><li><a href=#workaround-if-any>Workaround (if any)</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>Moohoo everyone!</strong></p><p>As announced in the last blog entry (dated 30.05.2023), here is the detailed CVE for security patch 2023-05a.</p><p>If you have not yet updated, you should do so as soon as possible, because an exploit is now publicly available on the Internet that could be exploited by authenticated users on your mail server.</p><h3 id=impact class=heading-element><a href=#impact class=heading-mark></a>Impact</h3><p>On May 30, 2023, a vulnerability was discovered in mailcow. The vulnerability allows an attacker to manipulate internal Dovecot variables by using specially crafted passwords during the authentication process.</p><p>The issue arises from the behavior of the <code>passwd-verify.lua</code> script, which is responsible during login. Upon a successful login, the script returns a response in the format of <code>password=</code>, indicating the successful authentication.</p><p>By crafting a password with additional key-value pairs appended to it, an attacker can manipulate the returned string and influence the internal behavior of Dovecot. For example, using the password <code>123 mail_crypt_save_version=0</code> would cause the passwd-verify.lua script to return the string <code>password=123 mail_crypt_save_version=0</code>. Consequently, Dovecot will interpret this string and set the internal variables accordingly, leading to unintended consequences.</p><p>By changing the password to a specific payload, the vulnerability can be exploited during the login process using the special-crafted password. Successful exploitation could result in unauthorized access to user accounts, bypassing security controls, or other malicious activities.</p><h3 id=what-has-been-done-about-this-vulnerability class=heading-element><a href=#what-has-been-done-about-this-vulnerability class=heading-mark></a>What has been done about this vulnerability?</h3><p>On the same day, a hotfix (2023-05a) was released to fix the vulnerability.</p><p>This means that it is no longer possible to exploit this vulnerability.</p><h3 id=affected-versions class=heading-element><a href=#affected-versions class=heading-mark></a>Affected Versions</h3><blockquote><p>Basically <strong>everything before</strong> the 2023-05a update.</p></blockquote><p>The impacted file <code>passwd-verify.lua</code> has been in mailcow: dockerized code for almost 3 years.</p><h3 id=workaround-if-any class=heading-element><a href=#workaround-if-any class=heading-mark></a>Workaround (if any)</h3><blockquote><p>In short: <strong>NONE!</strong></p></blockquote><p>There is no workaround for this problem because every user can change and set his own password and this function cannot be restricted by an ACL.</p><p>In general, we recommend updating the mail system on a regular basis. Updates are very important in the IT world and protect against vulnerabilities like this.</p><h3 id=references class=heading-element><a href=#references class=heading-mark></a>References</h3><p>We thank the finder of this exploit and refer to his reference:</p><p><a href=https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md target=_blank rel="external nofollow noopener noreferrer">https://github.com/VladimirBorisov/CVE_proposal/blob/main/MailcowUserPassword.md</a></p><hr><p>For further inquiries about this CVE, please do not hesitate to contact us at <a href=mailto:info@servercow.de>info@servercow.de</a>.</p><p>Please make sure that your mail server <strong>always</strong> has a current patch level!</p><p>Stay healthy and happy mailing!</p><p>Your mailcow Team</p><blockquote><p>Niklas aka. DerLinkman</p></blockquote></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2024-02-29 12:14:30">Updated on 02-29-2024&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/2023/ class=post-tag title="Tags - 2023">2023</a><a href=/tags/security/ class=post-tag title="Tags - Security">Security</a><a href=/tags/important/ class=post-tag title="Tags - Important">Important</a><a href=/tags/cve/ class=post-tag title="Tags - Cve">Cve</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2023/release-2023-05a/ class=post-nav-item rel=prev title="üå∑üêÑ Mooay Update 2023 - Revision A (‚ö†Ô∏è CRITICAL security update ‚ö†Ô∏è)"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>üå∑üêÑ Mooay Update 2023 - Revision A (‚ö†Ô∏è CRITICAL security update ‚ö†Ô∏è)</a>
<a href=/posts/2023/spamhaus-dnsblocklist/ class=post-nav-item rel=next title="üõëüìú Spamhaus DNS Blocklist changes since 2023-07">üõëüìú Spamhaus DNS Blocklist changes since 2023-07<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=Contents><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line custom"><a href=/imprint/>Imprint</a> | <a href=/policy/>Privacy Policy</div><div class="footer-line powered">Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.123.6"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Theme - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.1"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2016 - 2024</span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://tinc.gmbh?kontakt target=_blank>The Infrastructure Company GmbH</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><div id=mask></div><noscript><div class=noscript-warning>Theme FixIt works best with JavaScript enabled.</div></noscript></div><link rel=preload href=/lib/katex/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/katex/katex.min.css></noscript><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script>window.config={code:{copyTitle:"Copy to clipboard",editLockTitle:"Lock editable code block",editUnLockTitle:"Unlock editable code block",editable:!0,maxShownLines:10},comment:{enable:!1},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script src=/js/theme.min.js defer></script></body></html>